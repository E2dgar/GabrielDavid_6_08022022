(()=>{"use strict";const e="assets/photographers/",t=async()=>{try{const e=await fetch("src/js/data/photographers.json");return await e.json()}catch(e){console.log(e)}},o=(e,t,o,n)=>{const a=document.createElement(e);return t&&(a.className=t),o&&o.forEach((e=>{a.setAttribute(e.name,e.value)})),n&&(a.textContent=n),a},n=e=>{const t=document.querySelector("header");if(!document.querySelector("header a")){const e=o("a","data-link",[{name:"href",value:"#"}]),n=o("img","logo",[{name:"alt",value:"Fisheye Home page"},{name:"src",value:"assets/images/logo.png"}]);e.append(n),t.append(e)}if(!document.querySelector("header h1")){const n=o("h1","","",e);t.append(n)}document.querySelector("body").classList.contains("home-page")||(document.querySelector("header h1").remove(),console.log("delete"))},a=async()=>{document.querySelector("body").className="home-page",document.title="Fisheye ";const a=document.querySelector("section.hero-photographer"),s=document.querySelector("section.medias-section");a&&a.remove(),s&&s.remove(),n("Nos photographes");const{photographers:r}=await t(),c=document.getElementById("main-content");if(!document.querySelector("section.photographer-section")){const t=o("div","photographer-section",[{name:"id",value:"list"}]);r.forEach((n=>t.append(new class{constructor(e){this.name=e.name,this.id=e.id,this.city=e.city,this.country=e.country,this.tagline=e.tagline,this.price=e.price,this.portrait=e.portrait}createUserCard(){const t=o("article","photographer"),n=o("a","photographer-link data-link",[{name:"href",value:`#${this.id}`}]),a=o("div","media-container"),s=o("img","",[{name:"src",value:e+this.portrait},{name:"alt",value:this.name}]);a.append(s);const r=o("h2","","",this.name);n.append(a,r);const c=o("h3","","",`${this.country}, ${this.city}`),i=o("p","","",this.tagline),l=o("p","","",`${this.price}â‚¬/jour`);return t.append(n,c,i,l),t}}(n).createUserCard()))),c.append(t)}},s=e=>(console.log("facto",e.type),"image"===e.type?((e,t)=>{console.log("image :",t);const o=document.createElement("img");return o.setAttribute("alt",e),o.setAttribute("src","assets/medias/img/thumbs/"+t),o})(e.title,e.image):"video"===e.type?((e,t)=>{console.log("video :",t);const o=document.createElement("img");return o.setAttribute("alt",e),o.setAttribute("src","assets/medias/video/thumbs/"+t.replace(".","")+".png"),o})(e.title,e.video):"Format error"),r=e=>{const t=document.createElement("article");t.className="media-card";const n=document.createElement("div");n.className="img-container";const a=s(e);n.append(a);const r=document.createElement("p");r.className="media-legend";const c=document.createElement("h3");c.textContent=e.title;const i=document.createElement("span");i.textContent=e.likes;const l=o("button","like-button",[{name:"aria-label",value:"likes"}]);return l.append((()=>{const e=document.createElementNS("http://www.w3.org/2000/svg","svg");e.setAttribute("viewBox","0 0 20 20"),e.setAttribute("aria-hidden",!0);const t=document.createElementNS("http://www.w3.org/2000/svg","path");return t.setAttribute("d","M9.5 18.35L8.23125 17.03C3.725 12.36 0.75 9.28 0.75 5.5C0.75 2.42 2.8675 0 5.5625 0C7.085 0 8.54625 0.81 9.5 2.09C10.4537 0.81 11.915 0 13.4375 0C16.1325 0 18.25 2.42 18.25 5.5C18.25 9.28 15.275 12.36 10.7688 17.04L9.5 18.35Z"),e.append(t),e})()),r.append(c,i,l),t.append(n,r),t},c=class{constructor(e){console.log("media",e),this.title=e.title,this.likes=e.likes,this.date=e.date,this.price=e.price}},i=class extends c{constructor(e){super(e),this.type="image",this.image=e.image}},l=class extends c{constructor(e){super(e),this.type="video",this.video=e.video}},d=(t,a)=>{document.querySelector("body").className="photographer-page",n(),document.querySelector("#list").remove();const s=(t=>{console.log("hero photo");let n=document.querySelector("section.hero-photographer");n?n.remove():n=o("section","hero-photographer");const a=o("div"),s=o("h2","","",t.name),r=o("p","location","",t.city+", "+t.country),c=o("p","tagmine","",t.tagline);a.append(s,r,c);const i=o("button","","","Contactez-moi"),l=o("div","img-container"),d=o("img","",[{name:"src",value:e+t.portrait}]);return l.append(d),n.append(a,i,l),console.log("end of hero"),n})(t),c=a;console.log("await",c);const d=[];c.forEach((e=>{var t;console.log("perend ",e),console.log("stop",new i(e)),d.push((t=e).image?new i(t):t.video?new l(t):"Media format unknown")})),console.log("sorted",d);const p=(e=>{console.log("medias",e);let t=document.querySelector("section.medias-section");t&&t.remove(),t=o("section","medias-section");const n=o("div","medias-wrapper");return e.forEach((e=>{console.log(r(e)),n.append(r(e))})),t.append(n),console.log("typ",t),t})(d);console.log("gal",p);const m=document.querySelector("#main-content");return m.append(s,p),m};window.onload=()=>{history.pushState(null,null,window.location.pathname);const e=document.querySelectorAll(".data-link");let t="";e.forEach((e=>{e.addEventListener("click",(e=>{e.preventDefault(),t=e.target.closest("a").href,history.pushState(null,null,window.location.pathname+t)}))})),a()},window.onpopstate=async()=>{const{photographers:e}=await t(),o=window.location.hash.substring(1);if(""!==o&&"main-content"!==o){const n=e.filter((e=>e.id===parseInt(o)));console.log("filt",n);const a=new class{constructor(e){this.name=e.name,this.id=e.id,this.city=e.city,this.country=e.country,this.tagline=e.tagline,this.price=e.price,this.portrait=e.portrait}async getMedias(){const{media:e}=await t();return e.filter((e=>this.id===parseInt(e.photographerId)))}}(n[0]);console.log("ph",a),d(a,await a.getMedias())}else a()}})();